<!DOCTYPE html>
<html lang="en">

<head>
  <title>Decision Maker - Poll Results</title>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Acme&family=Righteous&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/vendor/normalize-4.1.1.css" />
  <link rel="stylesheet" href="/vendor/border-box.css" />
  <link rel="stylesheet" href="/styles/main.css" />
  <link rel="stylesheet" href="/styles/layout.css" />
  <link rel="stylesheet" href="/styles/nav.css" />
  <link rel="stylesheet" href="/styles/footer.css" />
  <link rel="stylesheet" href="/styles/result.css" />

  <script src="/vendor/jquery-3.0.0.js"></script>
  <script defer src="/scripts/app.js"></script>
  <script type="text/javascript" src="/scripts/client.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>
  <nav>
    <span id="title">Decision Maker</span>
    <div class="subtext">
      <span>Create a New Poll</span>
    </div>
  </nav>
  <main class="container">
    <div class="poll-results-info">
      <h2>Poll Results</h2>
      <h3>
        <%= pollObj.title %>
      </h3>

      <div class="winner">
        <p>The winner is: <%= winningChoices.join(', ') %>
        </p>
      </div>
    </div>

    <div id="chart-container">
      <canvas id="myChart"></canvas>
    </div>

    <p class="borda-note">Results were calculated using the <a class="borda-link"
        href="https://en.wikipedia.org/wiki/Borda_count">Borda Count</a> method</p>

    <script>
      const ctx = document.getElementById('myChart');
      const choice1 = '<%= pollObj.choice_1 %>';
      const choice2 = '<%= pollObj.choice_2 %>';
      const choice3 = '<%= pollObj.choice_3 %>';
      const total1 = '<%= result[0].total_choice_1 %>';
      const total2 = '<%= result[0].total_choice_2 %>';
      const total3 = '<%= result[0].total_choice_3 %>';
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: [choice1, choice2, choice3],
          datasets: [{
            label: 'Points',
            data: [total1, total2, total3],
            backgroundColor: ['rgba(255, 99, 132, 0.8)', 'rgba(54, 162, 235, 0.8)', 'rgba(255, 205, 86, 0.8)'],
          }]
        },
        options: {
          indexAxis: 'y',
          elements: {
            bar: {
              borderWidth: 2,
            }
          },
          responsive: true,
          scales: {
            y: {
              beginAtZero: true,
              stepSize: 1,
              ticks: {
                color: '#c1bee3',
                font: {
                  size: 15,
                }
              },
              grid: {
                display: false,
              }
            },
            x: {
              display: false,
              ticks: {
                display: false,
              },
              grid: {
                display: false,
              }
            }
          },
          plugins: {
            legend: {
              display: false,
            }
          }
        }
      });

    </script>


  </main>

  <footer>
    <button form="start-again" class="button switch" type="submit" id="start-again"><a class="foot-button"
        href="http://localhost:8080/polls">CREATE NEW POLL</a></button>
  </footer>

</body>

</html>
